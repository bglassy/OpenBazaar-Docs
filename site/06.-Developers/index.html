<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.png">

	<title>Developers - OpenBazaar Docs</title>
        
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">


<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js"></script>
        
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>
        <!-- Preloader -->
<div id="preloader">
	<div id="status">&nbsp;</div>
</div>

        
        <div class="header_wrapper">
            <div class="navbar navbar-default" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="..">OpenBazaar Docs</a>
        </div>
        
       
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#obdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
               
                
            </ul>
        </div>
    </div>
                <div class="navbar-two" role="navigation">
    <div class="container">
<!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav" style="">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../02.-Getting-Started/">Getting Started</a>
                    </li>
                
                
                
                    <li >
                        <a href="../03.-OpenBazaar-Protocol/">Protocol</a>
                    </li>
                
                
                
                    <li >
                        <a href="../04.-Marketplaces/">Marketplaces</a>
                    </li>
                
                
                
                    <li >
                        <a href="../05.-Roadmap/">Roadmap</a>
                    </li>
                
                
                
                    <li class="active">
                        <a href="./">Developers</a>
                    </li>
                
                
                
                    <li >
                        <a href="../07.-Articles/">Articles</a>
                    </li>
                
                
                
                    <li >
                        <a href="../08.-Reference-Documentation/">References</a>
                    </li>
                
                
                
                    <li >
                        <a href="../09.-Frequently-Asked-Questions/">FAQ</a>
                    </li>
                
                
                </ul>
            
        </div>
    </div>
</div>
        </div>

        <div class="container" style="margin-top: 60px;">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#6-developers">6. Developers</a></li>
        
            <li><a href="#61-web-socket-api">6.1 Web Socket API</a></li>
        
    
          <hr>
        <h4 style="text-align: center;"><a href="https://github.com/OpenBazaar/OpenBazaar/wiki">Contribute to the Docs</a></h4>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="6-developers">6. Developers</h1>
<h2 id="61-web-socket-api">6.1 Web Socket API</h2>
<p>The OpenBazaar reference client when running listens on a websocket for messages from the web client.  Future versions may use an encrypted websocket listener. Your running client web socket will be available at: </p>
<pre><code>ws://127.0.0.1:&lt;OpenBazaar_Port&gt;/ws
</code></pre>
<p>Every message will consist of a unique id for the request and a results key-value in JSON containing the data that was requested. This is an example of a <em>peers</em> message.</p>
<pre><code>{"id": 24637, "result": {"peers": [{"hostname": "xxx.xxx.xxx.xxx", "sin": "9xHVXXi2Lv7tcchgTPLFDDF2qdaP44bDD3yXvP", "nick": "Store Name", "reachable": true, "guid": "d5a848a0957838a2707b92cca9741cb71ab432k3", "pubkey": "044dbc7389598f7d5f133fe11fcec58be344e288ff0acba6bd582131cd2d1a7d7fac59fbe0454257d11e5cb00e1945b02d25679f35ce72af77510f32bb8cdd23433", "port": 12345}], "type": "peers"}}
</code></pre>
<h3 id="messages">Messages</h3>
<p>The following section outlines all of the messages and formats that the websocket API enables.</p>
<ul>
<li><a href="https://github.com/OpenBazaar/OpenBazaar/wiki/Web-Socket-API#gui-messages">GUI Messages</a></li>
<li><a href="https://github.com/OpenBazaar/OpenBazaar/wiki/Web-Socket-API#market">Market</a></li>
<li><a href="https://github.com/OpenBazaar/OpenBazaar/wiki/Web-Socket-API#peer-to-peer-network">Peer to Peer Network</a></li>
</ul>
<h4 id="gui-messages">GUI Messages</h4>
<p>These messages are used for interacting with the GUI.</p>
<h5 id="republish_notify">republish_notify</h5>
<p>Example:</p>
<pre><code>{
    "id": 843536, 
    "result": 
    {
        "msg": "P2P Data Republished", 
        "type": "republish_notify"
    }
}
</code></pre>
<h5 id="peers">peers</h5>
<p>Provides a list of peers and their metadata. Used in the GUI for constructing the sidebar of markets available.</p>
<p>Example:</p>
<pre><code>    {
        "id": 24637, 
        "result": 
        {
            "peers": [
                        {"hostname": "XXX.XXX.XXX.XXX", "sin": "", "nick": "Default", "reachable": true, "guid": "", "pubkey": "", "port": 12345}, 
                        {"hostname": "XXX.XXX.XXX.XXX", "sin": "", "nick": "Notary", "reachable": true, "guid": "", "pubkey": "", "port": 56023}
                     ],
            "type": "peers"
        }
    }
</code></pre>
<h4 id="market">Market</h4>
<p>These requests are used to manage your account/market on the network.</p>
<h5 id="create_contract">create_contract</h5>
<pre><code>{
  "id": 42,
  "command": "create_contract",
  "params": {
    "Contract_Metadata": {
      "OBCv": "0.4",
      "category": "physical_goods",
      "subcategory": "fixed_price",
      "contract_nonce": "01",
      "expiration": "2014-01-01 00:00:00"
    },
    "Seller": {
      "seller_GUID": "",
      "seller_BTC_uncompressed_pubkey": "",
      "seller_PGP": ""
    },
    "Contract": {
      "item_title": "asfd",
      "item_keywords": [

      ],
      "currency": "XBT",
      "item_price": 0.5,
      "item_condition": "New",
      "item_quantity": 1,
      "item_desc": "asfddasf",
      "item_images": {

      },
      "item_remote_images": [

      ],
      "item_delivery": {
        "countries": "",
        "region": "",
        "est_delivery": "",
        "shipping_price": 0
      }
    }
  }
}
</code></pre>
<h5 id="check_order_count">check_order_count</h5>
<p>Request:</p>
<pre><code>{
    "id":42,
    "command":"check_order_count",
    "params":{}
}
</code></pre>
<p>Response:</p>
<pre><code>{
    "id": 28796,
    "result": 
    {
        "count": 1, 
        "type": "order_count"
    }
}
</code></pre>
<h5 id="update_settings">update_settings</h5>
<p>Request:</p>
<pre><code>{
  "id": 42,
  "command": "update_settings",
  "params": {
    "type": "update_settings",
    "settings": {
      "countryCode": "",
      "stateRegion": "",
      "guid": "67e53acbd794f702768bb6beca33322120e8d353",
      "id": 1,
      "privkey": "",
      "city": "",
      "notaries": [
        {
          "nickname": "Default",
          "guid": "7a9112bc8f7f7558d75d31420d8a36a5e5ec965b",
          "$$hashKey": "00G"
        }
      ],
      "zip": "",
      "market_id": 1,
      "arbiterDescription": "",
      "secret": "",
      "street1": "",
      "pubkey": "",
      "sin": "Tf71nA7HPeCuiMTxLmSfhGdi2bQWvQqEg8a",
      "storeDescription": "",
      "obelisk": "obelisk-baltic.airbitz.co:9091",
      "namecoin_id": "",
      "street2": "",
      "welcome": "enable",
      "recipient_name": "",
      "arbiter": "",
      "notary": "True",
      "bitmessage": "",
      "PGPPubKey": "",
      "bcAddress": "",
      "country": "",
      "bip32_seed": "",
      "PGPPubkeyFingerprint": "",
      "email": "",
      "nickname": "Default",
      "trustedArbiters": [

      ],
      "stateProvinceRegion": "",
      "burnAmount": 0,
      "burnAddr": "1AUMCv6Vo6bUJCHWjayECuyUVLent5apRm"
    }
  }
}
</code></pre>
<h5 id="get_notaries">get_notaries</h5>
<p>Retrieve all of the trusted notaries for your marketplace.</p>
<p>Request:</p>
<pre><code>{
    "id":42,
    "command":"get_notaries",
    "params":{}
}
</code></pre>
<p>Response:</p>
<pre><code>{
    "id": 937628, 
    "result": 
    {
        "notaries": [
            {"nickname": "Default", "guid": "7a9112bc8f7f7558d75d31420d8a36a5e5ec965b", "$$hashKey": "00G"}
        ], 
        "type": "settings_notaries"
    }
}
</code></pre>
<h4 id="peer-to-peer-network">Peer to Peer Network</h4>
<p>These requests are sent to the peer to peer network.</p>
<h5 id="hello">hello</h5>
<p>Hello messages are one-way notices of presence from one node to another.</p>
<p>Request:</p>
<pre><code>{
  "id": 66273,
  "result": {
    "senderNick": "Default",
    "senderNamecoin": "",
    "type": "hello",
    "hostname": "127.0.0.1",
    "nat_type": "Restric NAT",
    "senderGUID": "",
    "v": "0.3.1",
    "pubkey": "",
    "port": 12346
  }
}
</code></pre>
<h5 id="query_page">query_page</h5>
<p>Queries information about a specific store by looking against it's GUID.</p>
<p>Request:</p>
<pre><code>{
    "id":42,
    "command":"query_page",
    "params": {
                  "type":"query_store_listings",
                  "findGUID":"d5a848a0957838a2707b92cca9741cb71ab4a754"
              }
}
</code></pre>
<p>Response:</p>
<pre><code>{
    "id": 269057, 
    "result": 
    {
        "senderGUID": "31fa9f7e807aaa2740a7803f7ba48d15f5c5a396", 
        "senderNick": "Default", 
        "bitmessage": "", 
        "senderNamecoin": "", 
        "text": "", 
        "uri": "tcp://127.0.0.1:12345", 
        "arbiter_description": "", 
        "email": "", 
        "nickname": "Default", 
        "arbiter": "", 
        "v": "0.3.1", 
        "notary": "", 
        "guid": "67e53acbd794f702768bb6beca33322120e8d353", 
        "type": "page", 
        "sin": "Tf26hJBmGci2o7rUwKqamiaNLNA6wL1SJSE", 
        "PGPPubKey": "", 
        "pubkey": ""
    }
}
</code></pre>
<h5 id="query_store_products">query_store_products</h5>
<p>Requesting product listings from another market will return asynchronously all of the contracts it is offering as store_contract messages. It is your responsibility to deal with them as they are received.</p>
<p>Request:</p>
<pre><code>{
    "id":42,
    "command":"query_store_products",
    "params":
    {
        "type":"query_store_products",
        "key":"31fa9f7e807aaa2740a7803f7ba48d15f5c5a396"
    }
}
</code></pre>
<p>Response:</p>
<pre><code>{
  "id": 532405,
  "result": {
    "type": "store_contract",
    "contract": {
      "senderNick": "Default",
      "senderNamecoin": "",
      "deleted": 0,
      "type": "listing_result",
      "senderGUID": "31fa9f7e807aaa2740a7803f7ba48d15f5c5a396",
      "unit_price": 0.5,
      "item_remote_images": [
        "http:\/\/i00.i.aliimg.com\/wsphoto\/v0\/1991723914_1\/Free-Shipping-Hot-Sale-Wholesale-Novelty-Items-Funny-Punch-Guns-Kid-s-Favourite-Jokes-for-Fun.jpg"
      ],
      "item_quantity_available": 1,
      "item_title": "Novelty Gun",
      "item_desc": "Toy gun.",
      "signed_contract_body": "",
      "item_images": {

      },
      "key": "8def8106bfed395ba39eb626b316edd879349fe5",
      "v": "0.3.1",
      "contract_body": **&lt;RICARDIAN CONTRACT OBJECT&gt;**,
      "item_condition": "New",
      "guid": "67e53acbd794f702768bb6beca33322120e8d353",
      "pubkey": "",
      "id": 379843,
      "shipping_price": 0
    }
  }
}
</code></pre>
<h5 id="findnode">findNode</h5>
<p>This call is used to find specific keys but can also be used to bootstrap your view of the network by passing your own GUID. If a node does not have a value for the DHT key you are searching for they should return a list of closest nodes to that key that they know about.</p>
<p>Request:</p>
<pre><code>{
    "id": 111970,
    "result":
    {
        "findID": "63307178a21db3ff7e4a2e8d6672e0a0dc52cddc",
        "senderNamecoin": "",
        "type": "findNode",
        "hostname": "XXX.XXX.XXX.XXX",
        "nat_type": "Restric NAT",
        "findValue": false,
        "senderGUID": "a9eb74d66581816f7e4b55ea26ef2b66a57bbf3c",
        "key": "fdf629eedacc5537e749f542241413f15ed7ad94",
        "v": "0.3.1",
        "senderNick": "Notary",
        "guid": "2743a65cd38e43c3aab2957ec5a50514a2ef9322",
        "pubkey": "04422453d12042ec7484c0147bd6deef03575234d62389676ed824583e2e024ae210ad263543841ad47e73b3f08a666eb0655d5efd1cc6dcb728ce76af8173381a",
         "port": 56023
    }
}
</code></pre>
<p>Response (value not found):</p>
<pre><code>{
  "id": 868758,
  "result": {
    "senderNick": "Default",
    "senderNamecoin": "",
    "foundNodes": [

    ],
    "hostname": "127.0.0.1",
    "senderGUID": "31fa9f7e807aaa2740a7803f7ba48d15f5c5a396",
    "v": "0.3.1",
    "findID": "a9572416269500d2adadb44ba36b9fdea6e13d9d",
    "guid": "67e53acbd794f702768bb6beca33322120e8d353",
    "type": "findNodeResponse",
    "port": 12345,
    "pubkey": ""
  }
}
</code></pre></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
                <p>Copyright &copy; 2015&nbsp; <a href="https://openbazaar.org">OpenBazaar</a>. <a href="https://creativecommons.org/licenses/by/4.0/">Some rights reserved</a>.</p>
            
        </footer>

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script>var base_url = '..';</script>
        <script data-main="../obdocs/js/search.js" src="../obdocs/js/require.js"></script>
        <script src="../js/base.js"></script>

        <div class="modal" id="obdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            Search the docs
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="obdocs-search-query">
                            </div>
                        </form>
                        <div id="obdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
<!-- Preloader -->
<script type="text/javascript">
	//<![CDATA[
		$(window).load(function() { // makes sure the whole site is loaded
			$('#status').fadeOut(); // will first fade out the loading animation
			$('#preloader').delay(800).fadeOut('slow'); // will fade out the white DIV that covers the website.
			$('body').delay(800).css({'overflow':'visible'});
		})
	//]]>
</script> 

    </body>
</html>
